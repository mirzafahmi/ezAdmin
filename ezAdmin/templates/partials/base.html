{%load static%}
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% if request %}
        <meta name="csrf-token" content="{{ csrf_token }}">
    {% endif %}
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/dark_mode.css' %}" id="dark-mode-styles">
    <link rel="stylesheet" href="{% static 'fontawesomefree/css/all.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/alert_box.css' %}">

    <!-- JavaScript -->
    <script src="{% static 'js/breadcrumbs_nav.js' %}"></script>
    <script src="{% static 'js/alert_box.js' %}"></script>
    <script src="{% static 'js/responsive_button.js' %}"></script>
    <script src="{% static 'js/raw_material_form_ajax.js' %}"></script>
    <script src="{% static 'js/disable_link_ajax.js' %}"></script>
    <script src="{% static 'js/purchasing_doc_modal_ajax.js' %}"></script>
    <script src="{% static 'js/raw_material_log_filter_ajax.js' %}"></script>
    <script src="{% static 'js/component_list_filter_ajax.js' %}"></script>

    <!-- jQuery, Popper.js, Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <!-- Favicon -->
    <link rel="icon" href="{% static 'icon/favicon.ico' %}" type="image/x-icon">
    <link rel="shortcut icon" href="{% static 'icon/favicon.ico' %}" type="image/x-icon">

    <title>medivenAdmin | {% block title %}{% endblock %}</title>
</head>
<body>
  {% include 'partials/nav.html' %}
  
  <div id="main-page" class="container-fluid main">

    {% if user.is_authenticated %} 
    <div class="container-md mt-3">
      <nav id="breadCrumbsNav" style="" aria-label="breadcrumb">
        <ol id="breadcrumbs-container" class="breadcrumb">
          
        </ol>
      </nav>
    </div>
    {% endif %}

    {% block content %}

    {% endblock %}

    {% block javascript %}

    {% endblock %}

    
  </div>

  <footer class="text-center">
    <!-- Grid container -->
    <div class="container">
      <!-- Section: Social media -->
      <section class="text-center">
        Contact at: <br>
        <!-- Facebook 
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-facebook-f"></i
        ></a>-->
  
        <!-- Twitter 
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-twitter"></i
        ></a>-->
  
        <!-- Google 
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-google"></i
        ></a>-->
  
        <!-- Instagram 
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-instagram"></i
        ></a>-->
  
        <!-- Linkedin -->
        <a class="btn btn-outline-dark btn-floating" href="" role="button" target="_blank">
          <i class="fab fa-linkedin-in"></i>
        </a>
  
        <!-- Github -->
        <a class="btn btn-outline-dark btn-floating" href="" role="button" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      </section>
      <!-- Section: Social media -->
    </div>
    <!-- Grid container -->
    <div class = "text-center pb-1">
      Powered by: <br>
      <img class = 'stack-icon' src="{% static 'icon/html.ico' %}" alt="HTML Icon">
      <img class = 'stack-icon' src="{% static 'icon/css.ico' %}" alt="CSS Icon">
      <img class = 'stack-icon' src="{% static 'icon/javascript.ico' %}" alt="javascript Icon">
      <img class = 'stack-icon' src="{% static 'icon/python.ico' %}" alt="python Icon">
      <img class = 'stack-icon' src="{% static 'icon/django.ico' %}" alt="django Icon">
      <img class = 'stack-icon' src="{% static 'icon/sqlite.ico' %}" alt="sqllite Icon">
    </div>
    <!-- Copyright -->
    <div class="text-center">
      Â© 2023 Copyright: ezAdmin
    </div>
    <!-- Copyright -->
  </footer>

  <script>
    breadCrumbs()
    $(document).ready(function () {
      const darkModeToggle = $('#dark-mode-toggle');
      const csrfToken = $('meta[name="csrf-token"]').attr('content');

      $.ajax({
        type: 'GET',
        url: '{% url "dashboard-update-dark-mode" %}',  // Replace with the actual endpoint to get user's dark mode preference
        success: function (response) {
          console.log(response)
            // Set the initial state of the toggle based on the response
            const initialDarkModeState = response.dark_mode;  // Assuming the response has a 'dark_mode' property
            darkModeToggle.prop('checked', initialDarkModeState);
            $('body').toggleClass('dark-mode', initialDarkModeState);
            $('#dark-mode-styles').prop('disabled', !initialDarkModeState);
        },
        error: function () {
            console.error('Failed to retrieve dark mode preference.');
        }
      });
  
      darkModeToggle.change(function () {
        const isChecked = darkModeToggle.prop('checked');
        $('body').toggleClass('dark-mode', isChecked);
        $('#dark-mode-styles').prop('disabled', !isChecked);

        //console.log(isChecked.toUpperCase().charAt(0) + isChecked.slice(1))
          $.ajax({
            type: 'POST',
            url: '{% url "dashboard-update-dark-mode" %}',  // Update this URL with your actual endpoint
            data: { dark_mode: isChecked.toString().charAt(0).toUpperCase() + isChecked.toString().slice(1) },
            headers: { 'X-CSRFToken': csrfToken },
            success: function () {
                // Optionally, you can update the styles dynamically here
                document.body.classList.toggle('dark-mode', isChecked);
            },
            error: function () {
                console.error('Failed to update dark mode preference.');
            }
        });
      });
  });
  </script>
</body>
</html>
